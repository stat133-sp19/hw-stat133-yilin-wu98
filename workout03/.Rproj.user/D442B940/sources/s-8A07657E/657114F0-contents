---
title: "lab11-yilin-wu"
author: "yilin-wu"
date: "April 19, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1 Number of characters per tweet
```{r}
rm(list=ls())
library(stringr)
text_emotion <- read.csv('https://raw.githubusercontent.com/ucb-stat133/stat133-labs/master/data/text-emotion.csv')
# x <- c('&amp','&quot','&lt','&gt')
# x_replace <- c('&','"','<','>')
# # str_replace_all(text_emotion$content,x,x_replace)
statistics <- str_length(text_emotion$content)
summary(statistics)
table(statistics)

#there is no tweet with 0 character
# there is 4 tweets with 1 character and their content as below
#their index are below
which(statistics==1)
text_emotion[which(statistics==1),'content']
#max tweet
text_emotion[which.max(statistics),'content']
which.max(statistics)
max(statistics)
hist(statistics,breaks=seq(1,max(statistics)+4,5),las=1)
```
# 2 Author(usernames)
```{r}
username_count <- str_length(text_emotion$author)
table(username_count)
text_emotion[str_detect(text_emotion$author,"\\W"),'author']
which.max(username_count)
text_emotion[which.max(username_count),'author']
```
# 3 Various Symbols and Strings
```{r}
sum(str_detect(text_emotion$content,'\\^'))
sum(str_detect(text_emotion$content,'\\${3,}'))
sum(!str_detect(text_emotion$content,'[aA]'))
head(text_emotion[!str_detect(text_emotion$content,'[aA]'),'content'],10)
count <- str_count(text_emotion$content,'!')
summary(count)
text_emotion[which.max(count),'content']
```
# 4 Sentiment
```{r}
library(dplyr)
unique(text_emotion$sentiment)
freq <- table(text_emotion$sentiment)
freq <- freq[order(freq,decreasing=FALSE)]/sum(freq)
barplot(freq,horiz=TRUE,las=1)
char_count <- str_length(text_emotion$content)
emotion <- data.frame('count'=char_count,sentiment=text_emotion$sentiment)
summarise(group_by(emotion,sentiment),avg_length=mean(count))

```
# 5 Hashtags
```{r}
text_emotion
text_emotion[str_detect(text_emotion$content,"[#]([:blank:]|^[:punct:])[^//d]"),'content']
barplot(table(hashtag_count))
mean(hashtag_count)
max(table(hashtag_count))

```
# 6 OMG
```{r}
sum(str_detect(text_emotion$content,'^(omg|OMG)'))
text_emotion[str_detect(text_emotion$content,'^(omg|OMG)[:space:]'),'content']
```







Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
